name: Openfire CI

env:
  CI: true
  OPENFIRE_VERSION: "4.9.0"

on: [push, pull_request]


jobs:
  run-action:

    name: Execute Github Action
    runs-on: ubuntu-latest

    steps:
      - name: Checkout local action
        uses: actions/checkout@v4
      
      - name: Run Openfire
        uses: igniterealtime/launch-openfire-action@v1.1.2
        with:
          version: ${{env.OPENFIRE_VERSION}}
      
      - name: Run the action that's developed in this repository
        uses: ./
        with:
          domain: 'example.org'
          adminAccountUsername: 'admin'
          adminAccountPassword: 'admin'
          disabledTests: 'EntityCapsTest,SoftwareInfoIntegrationTest,XmppConnectionIntegrationTest,StreamManagementTest,WaitForClosingStreamElementTest,IoTControlIntegrationTest,ModularXmppClientToServerConnectionLowLevelIntegrationTest,MultiUserChatOccupantIntegrationTest,MultiUserChatRolesAffiliationsPrivilegesIntegrationTest,ServiceDiscoveryIntegrationTest,VCardTempIntegrationTest'
          disabledSpecifications: 'RFC6121,XEP-0045,XEP-0066'
          logDir: ./output
